---
tags:
  - daily
created: 2025-06-08 Sun 16:04
updated: 2025-06-08 Sun 19:50
---

- 16:04:04 
	# requests の Response の bool 変換値
	
	トークン期限切れの際に自動でトークンリフレッシュを行うようにするために以下のように requests レスポンスの存在チェックをしたが False が返ってきたため想定通りに動かなかった。

	```Python
	try:
		return func(self, *args, **kwargs)
	except requests.exceptions.RequestException as e:
		if e.response and e.response.status_code == 401:
			# トークンリフレッシュ
			...
		else:
			raise
	```

	公式ドキュメントによると requests のレスポンスはステータスコードが 400 未満の時、つまりリクエストが成功したときに True が返るようになっているらしい。  
	そのため上記のような場合は `e.response is not None` のようにして存在チェックをする必要がある。  
	[requests.models — Requests 2.32.3 documentation](https://requests.readthedocs.io/en/latest/_modules/requests/models/#Response:~:text=status_code%7D%5D%3E%22-,def%20__bool__(self)%3A,-%22%22%22Returns%20True%20if)

```Python
r = requests.Response()

r.status_code = 200
print(bool(r)) # True

r.status_code = 400
print(bool(r)) # False
```
